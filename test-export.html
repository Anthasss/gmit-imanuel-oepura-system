<!DOCTYPE html>
<html>
<head>
    <title>Export Test</title>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf-autotable@latest/dist/jspdf.plugin.autotable.min.js"></script>
    <script src="https://unpkg.com/file-saver@latest/dist/FileSaver.min.js"></script>
</head>
<body>
    <h1>Export Test</h1>
    <button onclick="testXLSX()">Test XLSX Export</button>
    <button onclick="testCSV()">Test CSV Export</button>
    <button onclick="testPDF()">Test PDF Export</button>

    <script>
        const testData = [
            { nama: 'John Doe', email: 'john@example.com', status: 'Aktif' },
            { nama: 'Jane Smith', email: 'jane@example.com', status: 'Tidak Aktif' },
        ];

        function testXLSX() {
            const ws = XLSX.utils.json_to_sheet(testData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
            XLSX.writeFile(wb, "test.xlsx");
        }

        function testCSV() {
            const csvContent = "data:text/csv;charset=utf-8,"
                + Object.keys(testData[0]).join(",") + "\n"
                + testData.map(row => Object.values(row).join(",")).join("\n");

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "test.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function testPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.text('Test PDF Export', 10, 10);

            const headers = Object.keys(testData[0]);
            const rows = testData.map(item => Object.values(item));

            doc.autoTable({
                head: [headers],
                body: rows,
                startY: 20
            });

            doc.save('test.pdf');
        }
    </script>
</body>
</html>